---
phase: 02-decisioned-workflows-+-safety
plan: 01
type: execute
wave: 1
depends_on:
  - 01-compliance-output-foundations/01-01
  - 01-compliance-output-foundations/01-02
files_modified:
  - swift-expert-skill/references/decisions.md
  - swift-expert-skill/SKILL.md
autonomous: true

must_haves:
  truths:
    - "User can route a request to review or refactor using explicit intent cues."
    - "Workflow routing guidance points to the shared Constraints section to prevent drift."
    - "The routing decision is documented in a dedicated reference file."
  artifacts:
    - path: "swift-expert-skill/references/decisions.md"
      provides: "Review vs refactor decision cues and routing gates"
      contains: "Gate"
    - path: "swift-expert-skill/SKILL.md"
      provides: "Workflow routing section linked to decisions reference"
      contains: "Workflow Routing"
  key_links:
    - from: "swift-expert-skill/SKILL.md"
      to: "swift-expert-skill/references/decisions.md"
      via: "Markdown link in workflow routing section"
      pattern: "decisions\\.md"
---

<objective>
Define a single routing decision for review vs refactor and anchor it to shared constraints.

Purpose: Ensure consistent intent-based workflow selection without duplicating constraints.
Output: Routing reference and SKILL.md workflow entry updates.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-decisioned-workflows-+-safety/02-RESEARCH.md
@swift-expert-skill/SKILL.md
@swift-expert-skill/references/code-review-refactoring.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create routing decisions reference</name>
  <files>swift-expert-skill/references/decisions.md</files>
  <action>
Create a routing guide that decides review vs refactor using explicit intent cues.

- Include a short decision table with gates (intent cues, SwiftUI scope, risk cues).
- Provide concrete phrasing examples ("review/find issues" vs "refactor/change/implement").
- Specify how to handle ambiguous requests (ask for intent before proceeding).
- Add a note that the Constraints section in SKILL.md is mandatory for all workflows.
- Keep the guidance concise and avoid tool-specific steps or architecture mandates.
  </action>
  <verify>Open `swift-expert-skill/references/decisions.md` and confirm the decision table, intent cue examples, and constraints note are present.</verify>
  <done>Routing decisions are documented with explicit intent cues and an instruction to follow SKILL.md constraints.</done>
</task>

<task type="auto">
  <name>Task 2: Wire routing into SKILL.md</name>
  <files>swift-expert-skill/SKILL.md</files>
  <action>
Update SKILL.md to use the new routing reference without duplicating detailed rules.

- Replace or rename the existing "Workflow Decision Tree" section to "Workflow Routing".
- Add a direct link to `references/decisions.md` as the authoritative routing source.
- Keep the existing Constraints section as the single shared constraints block.
- Ensure the routing section explicitly states that workflows must follow Constraints.
- Add `decisions.md` to the Reference Files list.
  </action>
  <verify>Open `swift-expert-skill/SKILL.md` and confirm the "Workflow Routing" section links to `references/decisions.md` and references Constraints.</verify>
  <done>SKILL.md routes workflow selection via the decisions reference and preserves a single shared Constraints section.</done>
</task>

</tasks>

<verification>
- `swift-expert-skill/references/decisions.md` contains routing gates with intent cues.
- `swift-expert-skill/SKILL.md` links to the decisions reference and keeps Constraints as the sole shared block.
</verification>

<success_criteria>
- Users can select review vs refactor using the decisions reference.
- SKILL.md clearly points to routing guidance and reaffirms shared Constraints.
</success_criteria>

<output>
After completion, create `.planning/phases/02-decisioned-workflows-+-safety/02-01-SUMMARY.md`
</output>
