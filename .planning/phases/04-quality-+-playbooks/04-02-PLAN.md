---
phase: 04-quality-+-playbooks
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - swift-patterns/references/refactor-playbooks.md
  - swift-patterns/references/workflows-refactor.md
  - swift-patterns/SKILL.md
autonomous: true

must_haves:
  truths:
    - "User can follow a view extraction playbook that preserves state ownership and identity."
    - "User can migrate navigation safely while maintaining a single source of truth."
    - "User can hoist state without breaking bindings, updates, or async work."
  artifacts:
    - path: "swift-patterns/references/refactor-playbooks.md"
      provides: "Goal-based refactor playbooks for view extraction, navigation migration, and state hoisting."
      contains: "Playbook"
    - path: "swift-patterns/references/workflows-refactor.md"
      provides: "Refactor checklist linking to playbooks and invariants."
      contains: "Playbooks"
    - path: "swift-patterns/SKILL.md"
      provides: "Entry point link to refactor playbooks."
      contains: "refactor-playbooks.md"
  key_links:
    - from: "swift-patterns/references/workflows-refactor.md"
      to: "swift-patterns/references/refactor-playbooks.md"
      via: "Playbook pointer"
      pattern: "refactor-playbooks.md"
    - from: "swift-patterns/SKILL.md"
      to: "swift-patterns/references/refactor-playbooks.md"
      via: "Reference index"
      pattern: "refactor-playbooks.md"
    - from: "swift-patterns/references/refactor-playbooks.md"
      to: "swift-patterns/references/invariants.md"
      via: "Invariant checks"
      pattern: "invariants.md"
---

<objective>
Add goal-based refactor playbooks that guide common SwiftUI migrations safely.

Purpose: Deliver PLAY-01 with actionable, invariant-aligned steps for common refactors.
Output: New refactor playbooks reference plus workflow and SKILL wiring.
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-quality-+-playbooks/04-RESEARCH.md
@swift-patterns/references/workflows-refactor.md
@swift-patterns/references/invariants.md
@swift-patterns/references/state.md
@swift-patterns/references/navigation.md
@swift-patterns/references/view-composition.md
@swift-patterns/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create goal-based refactor playbooks</name>
  <files>swift-patterns/references/refactor-playbooks.md</files>
  <action>
Create a new refactor playbooks reference focused on behavior-preserving migrations.

- Add a short intro that anchors playbooks to invariants and behavior baselines.
- Add three playbooks with consistent structure (Goal, Pre-checks, Steps, Verify, Risk cues):
  1) View extraction (preserve state ownership, stable identity, and data flow).
  2) Navigation migration (e.g., legacy navigation to `NavigationStack` while keeping one source of truth).
  3) State hoisting (move state up without breaking bindings or async work).
- Each playbook must include explicit invariants to preserve and a verification checklist aligned to the refactor workflow.
- Cross-link to `invariants.md`, `state.md`, `navigation.md`, and `view-composition.md` for detailed guidance.
- Keep language constraint-aligned: no architecture mandates, no tool-specific steps, and avoid deep concurrency guidance.
  </action>
  <verify>Open `swift-patterns/references/refactor-playbooks.md` and confirm three playbooks with Goal/Pre-checks/Steps/Verify/Risk cues plus invariant links.</verify>
  <done>PLAY-01 guidance exists with step-by-step, invariant-aligned playbooks for common refactors.</done>
</task>

<task type="auto">
  <name>Task 2: Wire playbooks into refactor workflow and SKILL index</name>
  <files>
swift-patterns/references/workflows-refactor.md
swift-patterns/SKILL.md
  </files>
  <action>
Connect the new playbooks into the workflow and entry points.

- Update `workflows-refactor.md` to include a short "Playbooks" section that points to the new reference and explains when to use it (view extraction, navigation migration, state hoisting).
- Update `SKILL.md` Quick Decision Guide and Reference Files list to include `references/refactor-playbooks.md` with a short description.
- Ensure links are relative and consistent with existing reference links.
  </action>
  <verify>Open `swift-patterns/references/workflows-refactor.md` and `swift-patterns/SKILL.md` to confirm playbook links are present and correct.</verify>
  <done>Refactor workflow and SKILL entry points reference the new playbooks for discovery.</done>
</task>

</tasks>

<verification>
- `swift-patterns/references/refactor-playbooks.md` provides three goal-based playbooks aligned to invariants.
- Refactor workflow and SKILL index link to the playbooks for quick discovery.
</verification>

<success_criteria>
- PLAY-01 is satisfied with goal-based refactor playbooks for view extraction, navigation migration, and state hoisting.
</success_criteria>

<output>
After completion, create `.planning/phases/04-quality-+-playbooks/04-02-SUMMARY.md`
</output>
